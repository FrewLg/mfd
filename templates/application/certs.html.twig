{% extends 'base.html.twig' %}

{% block title %}Application index
{% endblock %}
{% block styles %}
	<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css"/>
{% endblock %}

{% block body %}
	{% import "common/macro/input.html.twig" as input_macro %}


	<div class="row">

		<div class="col-lg-12">

			<div class="card ">
				<div class="card-header container">
					Certificates ({{certs.totalItemCount}})
				</div>

				<div class="card-body container ">


					<div class="table-responsive">
						{% if is_granted("ROLE_VICE_CHAIR") or is_granted("ROLE_CHAIR")    or is_granted("ROLE_SECRETARY")   or is_granted("ROLE_COORDINATOR")   %}

							<table class="table table-striped table-bordered">
								<thead>
									<tr>
										<th>#</th>
										<th>Title</th>
										<th>Issued to</th>
										<th>Reference nubmber</th>
										<th nowrap='nowrap'>Application Date</th>
										<th>Status</th>
										<th>Action</th>
									</tr>
								</thead>
								<tbody>
									{% for application in certs %}
										<tr>
											<td>{{ loop.index }}</td>
											<td>


												<a class="text-primary" href="{{ path('application_show', {'id': application.id}) }}">{{ application.irbApplication.title }}</a>


											</td>
											<td>{{ application.irbApplication.submittedBy }}</td>
											<td>{{ application.certificateCode }}</td>
											<td>{{ application.validUntil|date('Y-m-d h:i') }}</td>

											<td>
												{% if application.approvedAt %}
													<span class='badge badge-soft-success'>
														Approved  
														
													</span>
														{{ application.ApprovedAt|date('y-m-d h:i') }}

												{% else %}
												 
												<span class='badge badge-soft-danger'>
														Pending</span>
		 
												{% endif %}

											</td>
											<td>
												{% if application.approvedAt %}
											 

												<a   href="#" class='btn btn-soft-secondary'>Approved</a>

												{% else %}
												 
												
												<a   href="{{ path('approve', {'id': application.id}) }}" class='btn btn-soft-success'>Approve</a>

												{% endif %}

											</td>

										</tr>
									{% else %}
										<tr>
											<td colspan="7">no records found</td>
										</tr>
									{% endfor %}
								</tbody>
							</table>
							<div class="navigation">{{ knp_pagination_render(certs ) }}</div>


						{% else %}
							<h4 class='text-danger'>You need higher privilage to view the content!</h4>

						{% endif %}
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}
