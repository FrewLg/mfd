{% extends 'base.html.twig' %}

{% block title %}Application index
{% endblock %}
{% block styles %}
	<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.css"/>
{% endblock %}

{% block body %}
	{% import "common/macro/input.html.twig" as input_macro %}


	<div class="row">
							{% if application_filter_form is defined %}
		
		<div class="col-lg-12 mb-2">
			<div class="accordion" id="accordionExample">
				<div class="accordion-item active">
					<h5 class="accordion-header m-0" id="headingOne">
						<button class="accordion-button fw-semibold collapsed" type="button" data-bs-toggle="collapse" data-bs-target="#collapseOne" aria-expanded="false" aria-controls="collapseOne">
							Filter
						</button>
					</h5>
					<div id="collapseOne" class="accordion-collapse collapse active" aria-labelledby="headingOne" data-bs-parent="#accordionExample" style="">
						<div class="accordion-body active">

								{{ form_start(application_filter_form) }}
								{% for child in application_filter_form.children %}
									{% if child.vars.name != "_token" %}

										{{input_macro.input(child)}}
									{% endif %}
								{% endfor %}
								{# <button class="btn  offset-6 col-3 float-right btn-warning my-3  schedule-submit-button" type="reset">Clear</button> #}
								<button class="btn mx-1  col-3 float-right btn-success my-3  schedule-submit-button" type="submit">Filter</button>

								{{ form_end(application_filter_form) }}

							


						</div>
					</div>
				</div>
			</div>
		</div>
		{% else %}
		
		{% endif %}
		<div class="col-lg-12">

			<div class="card ">
				<div class="card-header container">
					Applications({{applications.totalItemCount}})
				</div>

				<div class="card-body container ">


					<div class="table-responsive">
			 {% if is_granted("ROLE_VICE_CHAIR") or is_granted("ROLE_CHAIR")    or is_granted("ROLE_SECRETARY")   or is_granted("ROLE_COORDINATOR")   %}

						<table class="table table-striped table-bordered">
							<thead>
								<tr>
									<th>#</th>
									<th>Title</th>
									<th>Applicant</th>
									<th>Project Type</th>
									<th nowrap='nowrap'>Submitted Date</th>
									<th>Status</th>
 								</tr>
							</thead>
							<tbody>
								{% for application in applications %}
									<tr>
										<td>{{ loop.index }}</td>
										<td>
										
										 {% if is_granted("ROLE_VICE_CHAIR") or is_granted("ROLE_CHAIR")   or is_granted("ROLE_SECRETARY")     %}

											<a class="text-primary" href="{{ path('application_show', {'id': application.id}) }}">{{ application.title }}</a>
								{% else %}
						{{ application.title }}
								{% endif %}
										
										
										
										</td>
										<td>{{ application.submittedBy }}</td>
										<td>{{ application.projectType }}</td>
										<td>{{ application.createdAt|date('Y-m-d h:i') }}</td>

										<td>
											{% if application.status %}
								<span class='badge badge-soft-{{ application.status.type }}'>
																{{  application.status }}
															</span>
											
											{% endif %}

										</td>
										 
									</tr>
								{% else %}
									<tr>
										<td colspan="7">no records found</td>
									</tr>
								{% endfor %}
							</tbody>
						</table>
 <div class="navigation">{{ knp_pagination_render(applications ) }}</div>


						{% else %}
						<h4 class='text-danger'>You need higher privilage to view the content!</h4>
		
		{% endif %}
					</div>
				</div>
			</div>
		</div>
	</div>
{% endblock %}

{% block script %}
	<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/daterangepicker/daterangepicker.min.js"></script>


	<script type="text/javascript">
		$(function () {

$('.daterangerpicker').daterangepicker({
autoUpdateInput: false,
locale: {
cancelLabel: 'Clear'
}
});

$('.daterangerpicker').on('apply.daterangepicker', function (ev, picker) {
$(this).val(picker.startDate.format('MM/DD/YYYY') + ' - ' + picker.endDate.format('MM/DD/YYYY'));
});

$('.daterangerpicker').on('cancel.daterangepicker', function (ev, picker) {
$(this).val('');
});

});
	</script>
{% endblock %}
